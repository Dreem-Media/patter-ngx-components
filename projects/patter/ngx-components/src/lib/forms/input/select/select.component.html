<!-- eslint-disable @angular-eslint/template/role-has-required-aria -->
<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<div class="select-container">
  <button #selectButton type="button" class="select-button" [attr.aria-haspopup]="'listbox'" [attr.aria-expanded]="isOpen()"
    [attr.aria-labelledby]="labelId" (click)="toggleDialog()">
    <span [attr.id]="labelId">{{ value() || placeholder }}</span>
  </button>
  <dialog #selectDialog (keydown)="onDialogKeyDown($event)" [attr.aria-label]="'Options'" class="select-dialog">
    <div role="combobox" [attr.aria-expanded]="isOpen()" [attr.aria-owns]="listId">
      <input #searchInput [ngModel]="searchTerm()" (ngModelChange)="updateSearchTerm($event)"
        (keydown)="onInputKeyDown($event)" [attr.aria-autocomplete]="'list'" [attr.aria-controls]="listId"
        placeholder="Search..." class="search-input">
    </div>
    <ul [attr.id]="listId" role="listbox" class="option-list">
      @for (option of filteredOptions(); track option; let i = $index) {
      <li role="option" [attr.aria-selected]="option === value()" [class.selected]="option === value()"
        [class.highlighted]="i === highlightedIndex()" (click)="selectOption(option)"
        (keydown)="onOptionKeyDown($event, option)" [attr.tabindex]="i === highlightedIndex() ? 0 : -1">
        {{ option }}
      </li>
      }
    </ul>
  </dialog>
</div>

<hr class="my-3">

<form>
  <select>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
  </select>
</form>
